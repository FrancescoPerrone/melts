
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Machine Learning-Based Clustering of Micro-Analytical Mapping Data</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: #f7f9fb;
            color: #333;
        }
        header {
            background: #34495e;
            color: white;
            padding: 20px;
            text-align: center;
        }
        .subheader {
            font-size: 0.9em;
            color: #ecf0f1;
            margin-top: 5px;
        }
        .container {
            max-width: 1200px;
            margin: auto;
            padding: 20px;
        }
        #controls {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        label {
            font-weight: bold;
        }
        select {
            padding: 5px 10px;
        }
        .flex-display {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 20px;
        }
        .half {
            flex: 1;
            min-width: 400px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tbody tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        tbody tr:hover {
            background-color: #d6eaf8;
        }
        .chart {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Machine Learning-Based Clustering of Micro-Analytical Mapping Data</h1>
        <div class="subheader">Interactive Visualization Test Page â€” Francesco Perrone</div>
    </header>
    <div class="container">
        <div id="controls">
            <label for="clusterSelect">Choose Cluster:</label>
            <select id="clusterSelect" onchange="updatePlots()"></select>
        </div>

        <div class="flex-display">
            <div class="half">
                <h2>Elemental Composition Table</h2>
                <table id="dataTable">
                    <thead><tr><th>Element</th><th>Weight %</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
            <div class="half">
                <div id="barPlot" class="chart" style="height:400px;"></div>
                <div id="radarPlot" class="chart" style="height:400px;"></div>
            </div>
        </div>

        <div id="elementPieChart" class="chart" style="width:100%;height:500px;"></div>
    </div>

    <script>
        const data = {"Cluster_0": {"Al K\u03b1": 2.34, "As L\u03b1": 0.81, "Ba L\u03b1": 0.0, "Br L\u03b1": 2.34, "Cl K\u03b1": 0.0, "Dy L\u03b1": 1.23, "Fe K\u03b1": 1.23, "Mg K\u03b1": 0.81, "P K\u03b1": 0.7, "Pb M\u03b1": 0.0, "S K\u03b1": 0.0, "Si K\u03b1": 45.27, "Sr L\u03b1": 45.27, "Ti K\u03b1": 0.0}, "Cluster_1": {"Al K\u03b1": 1.32, "As L\u03b1": 0.0, "Ba L\u03b1": 0.0, "Br L\u03b1": 1.32, "Cl K\u03b1": 0.0, "Dy L\u03b1": 0.84, "Fe K\u03b1": 0.84, "Mg K\u03b1": 0.0, "P K\u03b1": 4.09, "Pb M\u03b1": 0.0, "S K\u03b1": 0.0, "Si K\u03b1": 45.8, "Sr L\u03b1": 45.8, "Ti K\u03b1": 0.0}, "Cluster_2": {"Al K\u03b1": 1.0, "As L\u03b1": 0.0, "Ba L\u03b1": 0.0, "Br L\u03b1": 1.0, "Cl K\u03b1": 0.0, "Dy L\u03b1": 0.84, "Fe K\u03b1": 0.84, "Mg K\u03b1": 0.0, "P K\u03b1": 21.82, "Pb M\u03b1": 0.0, "S K\u03b1": 0.0, "Si K\u03b1": 37.25, "Sr L\u03b1": 37.25, "Ti K\u03b1": 0.0}, "Cluster_3": {"Al K\u03b1": 1.31, "As L\u03b1": 0.0, "Ba L\u03b1": 0.77, "Br L\u03b1": 1.31, "Cl K\u03b1": 3.67, "Dy L\u03b1": 1.85, "Fe K\u03b1": 1.85, "Mg K\u03b1": 0.0, "P K\u03b1": 5.9, "Pb M\u03b1": 0.97, "S K\u03b1": 0.97, "Si K\u03b1": 40.31, "Sr L\u03b1": 40.31, "Ti K\u03b1": 0.77}, "Cluster_4": {"Al K\u03b1": 1.1, "As L\u03b1": 0.0, "Ba L\u03b1": 0.0, "Br L\u03b1": 1.1, "Cl K\u03b1": 0.0, "Dy L\u03b1": 0.74, "Fe K\u03b1": 0.74, "Mg K\u03b1": 0.0, "P K\u03b1": 0.98, "Pb M\u03b1": 0.0, "S K\u03b1": 0.0, "Si K\u03b1": 47.67, "Sr L\u03b1": 47.67, "Ti K\u03b1": 0.0}, "Cluster_5": {"Al K\u03b1": 1.47, "As L\u03b1": 0.0, "Ba L\u03b1": 0.0, "Br L\u03b1": 1.47, "Cl K\u03b1": 0.0, "Dy L\u03b1": 0.93, "Fe K\u03b1": 0.93, "Mg K\u03b1": 0.0, "P K\u03b1": 1.16, "Pb M\u03b1": 0.0, "S K\u03b1": 0.0, "Si K\u03b1": 47.02, "Sr L\u03b1": 47.02, "Ti K\u03b1": 0.0}, "Cluster_6": {"Al K\u03b1": 1.56, "As L\u03b1": 0.49, "Ba L\u03b1": 0.0, "Br L\u03b1": 1.56, "Cl K\u03b1": 0.0, "Dy L\u03b1": 1.0, "Fe K\u03b1": 1.0, "Mg K\u03b1": 0.49, "P K\u03b1": 7.27, "Pb M\u03b1": 0.0, "S K\u03b1": 0.0, "Si K\u03b1": 43.32, "Sr L\u03b1": 43.32, "Ti K\u03b1": 0.0}};
        const colorPalette = ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728',
                              '#9467bd', '#8c564b', '#e377c2', '#7f7f7f',
                              '#bcbd22', '#17becf'];

        window.onload = function () {
            const clusterSelect = document.getElementById("clusterSelect");
            Object.keys(data).forEach(cluster => {
                const option = document.createElement("option");
                option.value = cluster;
                option.text = cluster;
                clusterSelect.add(option);
            });
            updatePlots();
        };

        function updatePlots() {
            const cluster = document.getElementById("clusterSelect").value;
            const elements = Object.keys(data[cluster]);
            const values = Object.values(data[cluster]);

            Plotly.newPlot('barPlot', [{
                x: elements,
                y: values,
                type: 'bar',
                marker: {
                    color: colorPalette
                }
            }], {
                title: 'Elemental Composition (Bar Plot)',
                xaxis: { title: 'Element Line' },
                yaxis: { title: 'Weight %' },
                template: 'plotly_white'
            });

            Plotly.newPlot('radarPlot', [{
                type: 'scatterpolar',
                r: values,
                theta: elements,
                fill: 'toself',
                line: { color: '#e67e22' }
            }], {
                polar: { radialaxis: { visible: true, range: [0, Math.max(...values) + 5] } },
                title: 'Elemental Composition (Radar Plot)',
                template: 'plotly_white'
            });

            const tbody = document.querySelector("#dataTable tbody");
            tbody.innerHTML = "";
            elements.forEach((el, i) => {
                const row = document.createElement("tr");
                row.innerHTML = `<td>${el}</td><td>${values[i].toFixed(2)}</td>`;
                row.onclick = () => showElementPie(el);
                tbody.appendChild(row);
            });
        }

        function showElementPie(element) {
            const labels = [];
            const values = [];
            for (const [cluster, composition] of Object.entries(data)) {
                labels.push(cluster);
                values.push(composition[element] || 0);
            }
            Plotly.newPlot('elementPieChart', [{
                type: 'pie',
                labels: labels,
                values: values,
                textinfo: 'label+percent',
                hoverinfo: 'label+value'
            }], {
                title: "Distribution of '" + element + "' across Clusters",
                template: 'plotly_white'
            });
        }
    </script>
</body>
</html>
